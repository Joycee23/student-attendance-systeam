{"openapi":"3.0.0","info":{"title":"Student Attendance System API","version":"1.0.0","description":"API documentation for Student Attendance Management System with Face Recognition"},"servers":[{"url":"https://studentsattendance.duckdns.org","description":"Production server"},{"url":"http://localhost:5000","description":"Local development server"}],"security":[{"bearerAuth":[]}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{"Class":{"type":"object","properties":{"_id":{"type":"string","example":"652f0d94e12a5c28b4a321f1"},"name":{"type":"string","example":"CNTT K23A"},"courseYear":{"type":"string","example":2023},"lecturerId":{"type":"string","example":"652f0d94e12a5c28b4a321e0"},"students":{"type":"array","items":{"type":"string"}}},"required":["name","courseYear"]},"Notification":{"type":"object","properties":{"_id":{"type":"string","example":"652f10a3f23a9d3a6b121d43"},"title":{"type":"string","example":"Lịch học thay đổi"},"message":{"type":"string","example":"Buổi học thứ 3 sẽ dời sang thứ 5"},"recipient":{"type":"string","example":"student123"},"role":{"type":"string","enum":["student","lecturer","admin"]},"classId":{"type":"string","example":"652f0d94e12a5c28b4a321f1"},"read":{"type":"boolean","example":false},"createdAt":{"type":"string","format":"date-time"}},"required":["title","message"]}}},"paths":{"/api/attendance/sessions":{"get":{"summary":"Get all attendance sessions with pagination","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"Page number"},{"in":"query","name":"limit","schema":{"type":"integer","default":10},"description":"Number of sessions per page"}],"responses":{"200":{"description":"A list of attendance sessions"},"401":{"$ref":"#/components/responses/Unauthorized"}}},"post":{"summary":"Create a new attendance session","tags":["Attendance"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["classId","startTime","endTime"],"properties":{"classId":{"type":"string","description":"The ID of the class"},"startTime":{"type":"string","format":"date-time"},"endTime":{"type":"string","format":"date-time"},"location":{"type":"object","properties":{"type":{"type":"string","default":"Point"},"coordinates":{"type":"array","items":{"type":"number"},"example":[106.660172,10.762622]}}}}}}}},"responses":{"201":{"description":"Session created successfully"},"400":{"$ref":"#/components/responses/ValidationError"},"403":{"$ref":"#/components/responses/Forbidden"}}}},"/api/attendance/sessions/{id}":{"get":{"summary":"Get a single session by ID","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"The session ID"}],"responses":{"200":{"description":"Session data"},"404":{"$ref":"#/components/responses/NotFound"}}},"put":{"summary":"Update an attendance session","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"The session ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"startTime":{"type":"string","format":"date-time"},"endTime":{"type":"string","format":"date-time"}}}}}},"responses":{"200":{"description":"Session updated successfully"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"}}}},"/api/attendance/sessions/{id}/close":{"patch":{"summary":"Close an attendance session","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"The session ID"}],"responses":{"200":{"description":"Session closed successfully"},"403":{"$ref":"#/components/responses/Forbidden"}}}},"/api/attendance/sessions/{id}/cancel":{"patch":{"summary":"Cancel an attendance session","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"The session ID"}],"responses":{"200":{"description":"Session cancelled successfully"},"403":{"$ref":"#/components/responses/Forbidden"}}}},"/api/attendance/sessions/{id}/qr-code":{"post":{"summary":"Generate a QR code for a session","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"The session ID"}],"responses":{"200":{"description":"QR code generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"qrCodeData":{"type":"string","description":"Data to be encoded in the QR code"},"expiresAt":{"type":"string","format":"date-time"}}}}}},"403":{"$ref":"#/components/responses/Forbidden"}}}},"/api/attendance/check-in/manual":{"post":{"summary":"Manually check-in a student (by lecturer)","tags":["Attendance"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","studentId","status"],"properties":{"sessionId":{"type":"string"},"studentId":{"type":"string"},"status":{"type":"string","enum":["present","absent","late"],"default":"present"}}}}}},"responses":{"201":{"description":"Student checked in successfully"},"403":{"$ref":"#/components/responses/Forbidden"}}}},"/api/attendance/check-in/qr":{"post":{"summary":"Check-in by scanning a QR code (by student)","tags":["Attendance"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","qrCodeData"],"properties":{"sessionId":{"type":"string"},"qrCodeData":{"type":"string"}}}}}},"responses":{"201":{"description":"Check-in successful"},"400":{"description":"Invalid or expired QR code"}}}},"/api/attendance/check-in/face":{"post":{"summary":"Face recognition check-in (by student)","tags":["Attendance"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","imageBase64"],"properties":{"sessionId":{"type":"string","example":"507f1f77bcf86cd799439011"},"imageBase64":{"type":"string","description":"Base64 encoded face image"}}}}}},"responses":{"201":{"description":"Check-in successful"},"400":{"description":"Face not detected in image or other validation error"},"403":{"description":"Face does not match registered user"}}}},"/api/attendance/check-in/gps":{"post":{"summary":"GPS location check-in (by student)","tags":["Attendance"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","latitude","longitude"],"properties":{"sessionId":{"type":"string"},"latitude":{"type":"number"},"longitude":{"type":"number"}}}}}},"responses":{"201":{"description":"Check-in successful"},"400":{"description":"You are not within the allowed check-in area"}}}},"/api/attendance/history":{"get":{"summary":"Get attendance history for the current user","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}}],"responses":{"200":{"description":"A list of attendance records"}}}},"/api/attendance/statistics/student/{studentId}":{"get":{"summary":"Get attendance statistics for a specific student","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"studentId","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Attendance statistics for the student"},"403":{"$ref":"#/components/responses/Forbidden"},"404":{"$ref":"#/components/responses/NotFound"}}}},"/api/attendance/statistics/session/{sessionId}":{"get":{"summary":"Get statistics for a specific session (e.g., attendance rate)","tags":["Attendance"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"sessionId","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Attendance statistics for the session"},"404":{"$ref":"#/components/responses/NotFound"}}}},"/api/auth/register":{"post":{"summary":"Register new user","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["fullName","email","password","role"],"properties":{"fullName":{"type":"string","example":"Nguyen Van A"},"email":{"type":"string","example":"student@example.com"},"password":{"type":"string","example":"password123"},"role":{"type":"string","enum":["admin","lecturer","student"],"example":"student"},"studentCode":{"type":"string","example":"SV001"},"lecturerCode":{"type":"string","example":"GV001"},"phoneNumber":{"type":"string","example":"0123456789"}}}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"400":{"$ref":"#/components/responses/ValidationError"}}}},"/api/auth/login":{"post":{"summary":"Login user","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","example":"admin@example.com"},"password":{"type":"string","example":"password123"}}}}}},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"},"token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refreshToken":{"type":"string"}}}}}}}},"401":{"$ref":"#/components/responses/Unauthorized"}}}},"/api/auth/logout":{"post":{"summary":"Logout user","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Logout successful"}}}},"/api/auth/me":{"get":{"summary":"Get current user info","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"User info retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"}}}}}}}},"401":{"$ref":"#/components/responses/Unauthorized"}}}},"/api/auth/update-profile":{"put":{"summary":"Update user profile","tags":["Authentication"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"fullName":{"type":"string"},"phoneNumber":{"type":"string"},"dateOfBirth":{"type":"string","format":"date"},"address":{"type":"string"},"avatarUrl":{"type":"string"}}}}}},"responses":{"200":{"description":"Profile updated successfully"}}}},"/api/auth/change-password":{"put":{"summary":"Change password","tags":["Authentication"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["currentPassword","newPassword"],"properties":{"currentPassword":{"type":"string"},"newPassword":{"type":"string"}}}}}},"responses":{"200":{"description":"Password changed successfully"},"401":{"description":"Current password is incorrect"}}}},"/api/auth/forgot-password":{"post":{"summary":"Request password reset","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","example":"user@example.com"}}}}}},"responses":{"200":{"description":"Reset token sent to email"}}}},"/api/auth/reset-password/{token}":{"put":{"summary":"Reset password with token","tags":["Authentication"],"parameters":[{"in":"path","name":"token","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["newPassword"],"properties":{"newPassword":{"type":"string"}}}}}},"responses":{"200":{"description":"Password reset successfully"},"400":{"description":"Invalid or expired token"}}}},"/api/auth/refresh-token":{"post":{"summary":"Refresh access token","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["refreshToken"],"properties":{"refreshToken":{"type":"string"}}}}}},"responses":{"200":{"description":"Token refreshed successfully"}}}},"/api/auth/verify-email/{token}":{"get":{"summary":"Verify email with token","tags":["Authentication"],"parameters":[{"in":"path","name":"token","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Email verified successfully"}}}},"/api/auth/resend-verification":{"post":{"summary":"Resend verification email","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Verification email sent"}}}},"/api/classes":{"get":{"summary":"Lấy danh sách tất cả các lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","example":1}},{"in":"query","name":"limit","schema":{"type":"integer","example":10}}],"responses":{"200":{"description":"Danh sách lớp học"},"401":{"description":"Unauthorized"}}},"post":{"summary":"Tạo lớp mới (Admin hoặc Giảng viên)","tags":["Classes"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Class"}}}},"responses":{"201":{"description":"Lớp được tạo thành công"}}}},"/api/classes/statistics":{"get":{"summary":"Lấy thống kê lớp học (chỉ Admin)","tags":["Classes"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Dữ liệu thống kê"},"403":{"description":"Chỉ Admin được phép"}}}},"/api/classes/lecturer/{lecturerId}":{"get":{"summary":"Lấy danh sách lớp theo giảng viên","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"lecturerId","required":true,"schema":{"type":"string"},"description":"ID giảng viên"}],"responses":{"200":{"description":"Danh sách lớp của giảng viên"}}}},"/api/classes/course-year/{courseYear}":{"get":{"summary":"Lấy danh sách lớp theo năm học","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"courseYear","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Danh sách lớp theo năm"}}}},"/api/classes/{id}":{"get":{"summary":"Lấy thông tin chi tiết lớp học","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Thông tin lớp học"}}},"put":{"summary":"Cập nhật lớp học (Admin hoặc giảng viên sở hữu lớp)","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Class"}}}},"responses":{"200":{"description":"Cập nhật thành công"}}},"delete":{"summary":"Xóa lớp học (Admin)","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Xóa lớp thành công"}}}},"/api/classes/{id}/students":{"get":{"summary":"Lấy danh sách sinh viên trong lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Danh sách sinh viên"}}},"post":{"summary":"Thêm sinh viên vào lớp (Admin hoặc Giảng viên)","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"studentId":{"type":"string"}}}}}},"responses":{"200":{"description":"Thêm sinh viên thành công"}}}},"/api/classes/{id}/students/bulk":{"post":{"summary":"Thêm nhiều sinh viên vào lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"students":{"type":"array","items":{"type":"string"}}}}}}},"responses":{"200":{"description":"Thêm sinh viên thành công"}}}},"/api/classes/{id}/students/{studentId}":{"delete":{"summary":"Xóa sinh viên khỏi lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true},{"in":"path","name":"studentId","required":true}],"responses":{"200":{"description":"Xóa sinh viên khỏi lớp thành công"}}}},"/api/classes/{id}/courses":{"post":{"summary":"Gán khóa học cho lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"courseId":{"type":"string"}}}}}},"responses":{"200":{"description":"Thêm khóa học thành công"}}}},"/api/classes/{id}/courses/{courseId}":{"delete":{"summary":"Xóa khóa học khỏi lớp","tags":["Classes"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true},{"in":"path","name":"courseId","required":true}],"responses":{"200":{"description":"Xóa khóa học thành công"}}}},"/api/face-encodings":{"get":{"summary":"Lấy danh sách tất cả dữ liệu face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}},{"in":"query","name":"isActive","schema":{"type":"boolean"}},{"in":"query","name":"isVerified","schema":{"type":"boolean"}},{"in":"query","name":"search","schema":{"type":"string"},"description":"Tìm kiếm theo tên, mã sinh viên, email"}],"responses":{"200":{"description":"Trả về danh sách face encodings"}}},"post":{"summary":"Đăng ký face encoding mới","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["studentId","imageBase64"],"properties":{"studentId":{"type":"string","description":"ID của sinh viên"},"imageBase64":{"type":"string","description":"Ảnh khuôn mặt dạng base64"}}}}}},"responses":{"201":{"description":"Đăng ký face encoding thành công"}}}},"/api/face-encodings/statistics":{"get":{"summary":"Lấy thống kê face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Thống kê về face encodings"}}}},"/api/face-encodings/user/{userId}":{"get":{"summary":"Lấy face encoding theo user ID","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"userId","schema":{"type":"string"},"required":true,"description":"ID của người dùng"}]}},"/api/face-encodings/{id}":{"get":{"summary":"Lấy thông tin face encoding theo ID","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true,"description":"ID của face encoding"}]},"put":{"summary":"Cập nhật face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["imageBase64"],"properties":{"imageBase64":{"type":"string","description":"Ảnh khuôn mặt mới dạng base64"}}}}}},"responses":{"200":{"description":"Cập nhật face encoding thành công"}}},"delete":{"summary":"Xóa face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}],"responses":{"200":{"description":"Xóa face encoding thành công"}}}},"/api/face-encodings/{id}/verify":{"patch":{"summary":"Xác minh face encoding (Admin)","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}]}},"/api/face-encodings/{id}/deactivate":{"patch":{"summary":"Vô hiệu hóa face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"reason":{"type":"string","description":"Lý do vô hiệu hóa"}}}}}},"responses":{"200":{"description":"Vô hiệu hóa face encoding thành công"}}}},"/api/face-encodings/{id}/reactivate":{"patch":{"summary":"Kích hoạt lại face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}]}},"/api/face-encodings/{id}/images":{"post":{"summary":"Thêm ảnh vào face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["imageBase64"],"properties":{"imageBase64":{"type":"string","description":"Ảnh khuôn mặt dạng base64"}}}}}},"responses":{"200":{"description":"Thêm ảnh thành công"}}}},"/api/face-encodings/{id}/images/{imageUrl}":{"delete":{"summary":"Xóa ảnh khỏi face encoding","tags":["Face Encodings"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true,"description":"ID của face encoding"},{"in":"path","name":"imageUrl","schema":{"type":"string"},"required":true,"description":"URL của ảnh cần xóa"}]}},"/api":{"get":{"summary":"Thông tin tổng quan về API","tags":["System"],"responses":{"200":{"description":"Trả về thông tin phiên bản và danh sách endpoint chính"}}}},"/api/health":{"get":{"summary":"Kiểm tra tình trạng hoạt động của API","tags":["System"],"responses":{"200":{"description":"API đang hoạt động bình thường"}}}},"/api/notifications":{"get":{"summary":"Lấy danh sách thông báo của người dùng","tags":["Notifications"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","example":1}},{"in":"query","name":"limit","schema":{"type":"integer","example":10}}],"responses":{"200":{"description":"Danh sách thông báo"}}},"post":{"summary":"Tạo thông báo mới (Admin hoặc Giảng viên)","tags":["Notifications"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Notification"}}}},"responses":{"201":{"description":"Thông báo được tạo thành công"}}}},"/api/notifications/unread/count":{"get":{"summary":"Đếm số lượng thông báo chưa đọc","tags":["Notifications"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Trả về số lượng chưa đọc","content":{"application/json":{"schema":{"type":"object","properties":{"unreadCount":{"type":"integer","example":3}}}}}}}}},"/api/notifications/statistics":{"get":{"summary":"Lấy thống kê thông báo (Admin hoặc Giảng viên)","tags":["Notifications"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Dữ liệu thống kê"},"403":{"description":"Không có quyền truy cập"}}}},"/api/notifications/broadcast":{"post":{"summary":"Gửi thông báo broadcast đến vai trò hoặc lớp học","tags":["Notifications"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string"},"message":{"type":"string"},"target":{"type":"string","example":"class"},"targetId":{"type":"string","example":"652f0d94e12a5c28b4a321f1"}}}}}},"responses":{"200":{"description":"Gửi thông báo broadcast thành công"}}}},"/api/notifications/read-all":{"patch":{"summary":"Đánh dấu tất cả thông báo là đã đọc","tags":["Notifications"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Đã đánh dấu tất cả là đã đọc"}}}},"/api/notifications/{id}":{"get":{"summary":"Lấy thông tin chi tiết thông báo","tags":["Notifications"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Trả về chi tiết thông báo"}}},"delete":{"summary":"Xóa thông báo","tags":["Notifications"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Xóa thông báo thành công"}}}},"/api/notifications/{id}/read":{"patch":{"summary":"Đánh dấu một thông báo là đã đọc","tags":["Notifications"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Đánh dấu thành công"}}}},"/api/reports/class-attendance":{"post":{"summary":"Tạo báo cáo điểm danh theo lớp (Excel/PDF)","description":"Cho phép Admin hoặc Giảng viên xuất báo cáo điểm danh theo lớp học.","tags":["Reports"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"classId":{"type":"string","example":"66f24abcf9123d00123c9999"},"format":{"type":"string","enum":["pdf","excel"],"example":"pdf"}}}}}},"responses":{"200":{"description":"Trả về file báo cáo đã tạo"},"400":{"description":"Thiếu dữ liệu hoặc sai định dạng"},"401":{"description":"Không có quyền truy cập"}}}},"/api/reports/student-attendance":{"post":{"summary":"Tạo báo cáo điểm danh cho sinh viên","description":"Sinh viên có thể tạo báo cáo điểm danh cá nhân. Giảng viên/Admin có thể tạo cho bất kỳ sinh viên nào.","tags":["Reports"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"studentId":{"type":"string","example":"66f249def9123d00123c7777"},"format":{"type":"string","enum":["pdf","excel"],"example":"excel"}}}}}},"responses":{"200":{"description":"Trả về file báo cáo sinh viên"},"400":{"description":"Thiếu dữ liệu hoặc sai định dạng"},"401":{"description":"Không có quyền truy cập"}}}},"/api/reports/course-attendance":{"post":{"summary":"Tạo báo cáo điểm danh theo môn học","description":"Giảng viên hoặc Admin có thể tạo báo cáo tổng hợp theo môn học.","tags":["Reports"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"courseId":{"type":"string","example":"66f248aaf9123d00123c8888"},"format":{"type":"string","enum":["pdf","excel"],"example":"excel"}}}}}},"responses":{"200":{"description":"File báo cáo môn học"},"400":{"description":"Thiếu dữ liệu hoặc sai định dạng"},"401":{"description":"Không có quyền truy cập"}}}},"/api/reports/attendance-summary":{"post":{"summary":"Tạo báo cáo tổng hợp điểm danh toàn hệ thống","description":"Chỉ Admin có quyền tạo báo cáo tổng hợp toàn bộ hệ thống.","tags":["Reports"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"dateRange":{"type":"object","properties":{"start":{"type":"string","example":"2025-01-01"},"end":{"type":"string","example":"2025-12-31"}}},"format":{"type":"string","enum":["pdf","excel"],"example":"pdf"}}}}}},"responses":{"200":{"description":"File báo cáo tổng hợp toàn hệ thống"},"400":{"description":"Thiếu dữ liệu hoặc sai định dạng"},"401":{"description":"Không có quyền truy cập"}}}},"/api/security/access-logs":{"get":{"summary":"Lấy danh sách nhật ký truy cập hệ thống","description":"Trả về danh sách các lần truy cập API (dành cho Admin). Endpoint này hiện là placeholder.","tags":["Security"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Danh sách nhật ký truy cập (hiện là dữ liệu mô phỏng)","content":{"application/json":{"example":{"success":true,"message":"Access logs endpoint - To be implemented","data":[]}}}},"401":{"description":"Không có quyền truy cập"}}}},"/api/security/encryption/status":{"get":{"summary":"Kiểm tra trạng thái mã hóa hệ thống","description":"Trả về thông tin trạng thái mã hóa của hệ thống (ví dụ AES-256-CBC).","tags":["Security"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Thông tin trạng thái mã hóa","content":{"application/json":{"example":{"success":true,"message":"Encryption status - To be implemented","data":{"enabled":true,"algorithm":"AES-256-CBC"}}}}},"401":{"description":"Không có quyền truy cập"}}}},"/api/security/audit":{"post":{"summary":"Kích hoạt quy trình kiểm tra bảo mật","description":"Admin có thể gọi endpoint này để kích hoạt quá trình audit bảo mật toàn hệ thống.","tags":["Security"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Quy trình audit đã được kích hoạt","content":{"application/json":{"example":{"success":true,"message":"Security audit triggered - To be implemented"}}}},"401":{"description":"Không có quyền truy cập"}}}},"/api/settings/public":{"get":{"summary":"Lấy thông tin cấu hình công khai","description":"Trả về các cấu hình có thể truy cập công khai (không cần đăng nhập).","tags":["Settings"],"responses":{"200":{"description":"Thành công","content":{"application/json":{"example":{"success":true,"data":{"siteName":"Student Attendance System","maintenanceMode":false}}}}}}}},"/api/settings":{"get":{"summary":"Lấy toàn bộ cấu hình hệ thống","description":"Chỉ Admin có quyền xem các thiết lập toàn hệ thống.","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Danh sách cấu hình hệ thống"}}},"put":{"summary":"Cập nhật cấu hình hệ thống","description":"Chỉ Admin có thể cập nhật cấu hình toàn hệ thống.","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"siteName":{"type":"string","example":"Student Attendance Portal"},"timezone":{"type":"string","example":"Asia/Ho_Chi_Minh"}}}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/attendance":{"put":{"summary":"Cập nhật cấu hình điểm danh","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"example":{"lateThreshold":15,"autoMarkAbsent":true}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/ai":{"put":{"summary":"Cập nhật cấu hình AI","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"example":{"aiProvider":"OpenAI","apiKey":"sk-xxxxx"}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/storage":{"put":{"summary":"Cập nhật cấu hình lưu trữ","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"example":{"provider":"Supabase","bucket":"attendance-photos"}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/notifications":{"put":{"summary":"Cập nhật cấu hình thông báo","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"example":{"emailEnabled":true,"pushEnabled":false}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/security":{"put":{"summary":"Cập nhật cấu hình bảo mật","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"example":{"twoFactorAuth":true,"passwordPolicy":{"minLength":8,"requireSymbols":true}}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/features":{"put":{"summary":"Cập nhật các feature flags","tags":["Settings"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"example":{"aiEnabled":true,"autoSyncEnabled":false}}}},"responses":{"200":{"description":"Cập nhật thành công"}}}},"/api/settings/maintenance":{"patch":{"summary":"Bật/tắt chế độ bảo trì hệ thống","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Trạng thái bảo trì được cập nhật"}}}},"/api/settings/validate/ai-service":{"get":{"summary":"Kiểm tra kết nối với dịch vụ AI","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Kết quả kiểm tra kết nối AI"}}}},"/api/settings/validate/storage":{"get":{"summary":"Kiểm tra cấu hình lưu trữ","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Kiểm tra cấu hình lưu trữ thành công"}}}},"/api/settings/validate/email":{"get":{"summary":"Kiểm tra cấu hình email","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cấu hình email hợp lệ"}}}},"/api/settings/validate/all":{"get":{"summary":"Kiểm tra tất cả các cấu hình hệ thống","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Kết quả kiểm tra tổng hợp"}}}},"/api/settings/reset":{"post":{"summary":"Đặt lại toàn bộ cấu hình về mặc định","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Đặt lại thành công"}}}},"/api/settings/history":{"get":{"summary":"Lấy lịch sử thay đổi cấu hình","tags":["Settings"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Danh sách lịch sử thay đổi"}}}},"/api/statistics/overview":{"get":{"summary":"Lấy thống kê tổng quan hệ thống (tổng người dùng, lớp học, tỷ lệ điểm danh, ...)","tags":["Statistics"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Thống kê tổng quan hệ thống"}}}},"/api/statistics/class/{classId}":{"get":{"summary":"Lấy thống kê điểm danh cho một lớp cụ thể","tags":["Statistics"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"classId","schema":{"type":"string"},"required":true,"description":"ID của lớp học cần lấy thống kê"}],"responses":{"200":{"description":"Trả về thống kê của lớp học"}}}},"/api/statistics/student/{studentId}":{"get":{"summary":"Lấy thống kê điểm danh của một sinh viên","tags":["Statistics"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"studentId","schema":{"type":"string"},"required":true,"description":"ID sinh viên"}],"responses":{"200":{"description":"Trả về thống kê điểm danh của sinh viên"}}}},"/api/statistics/lecturer/{lecturerId}":{"get":{"summary":"Lấy thống kê điểm danh của một giảng viên","tags":["Statistics"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"lecturerId","schema":{"type":"string"},"required":true,"description":"ID giảng viên"}],"responses":{"200":{"description":"Trả về thống kê điểm danh của giảng viên"}}}},"/api/statistics/trends":{"get":{"summary":"Lấy xu hướng điểm danh (theo tuần / tháng)","tags":["Statistics"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"period","schema":{"type":"string","enum":["week","month"],"default":"month"},"description":"Khoảng thời gian thống kê"}],"responses":{"200":{"description":"Biểu đồ xu hướng điểm danh"}}}},"/api/subjects":{"get":{"summary":"Get all subjects","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"page","in":"query","description":"Page number","required":false,"schema":{"type":"integer"}},{"name":"limit","in":"query","description":"Number of items per page","required":false,"schema":{"type":"integer"}}],"responses":{"200":{"description":"List of subjects"}}},"post":{"summary":"Create a new subject","tags":["Subjects"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","code"],"properties":{"name":{"type":"string"},"code":{"type":"string"},"description":{"type":"string"}}}}}},"responses":{"201":{"description":"Subject created successfully"}}}},"/api/subjects/statistics":{"get":{"summary":"Get subject statistics","tags":["Subjects"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Subject statistics"}}}},"/api/subjects/search":{"get":{"summary":"Search subjects","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"keyword","in":"query","description":"Keyword to search","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"List of matching subjects"}}}},"/api/subjects/lecturer/{lecturerId}":{"get":{"summary":"Get subjects by lecturer ID","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"lecturerId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Subjects taught by lecturer"}}}},"/api/subjects/class/{classId}":{"get":{"summary":"Get subjects by class ID","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"classId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Subjects assigned to class"}}}},"/api/subjects/{id}":{"get":{"summary":"Get subject by ID","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Subject details"}}},"put":{"summary":"Update subject","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string"},"code":{"type":"string"},"description":{"type":"string"}}}}}},"responses":{"200":{"description":"Subject updated successfully"}}},"delete":{"summary":"Delete subject","tags":["Subjects"],"security":[{"bearerAuth":[]}],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Subject deleted successfully"}}}},"/api/users":{"get":{"summary":"Lấy danh sách tất cả người dùng","tags":["Users"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}}],"responses":{"200":{"description":"Trả về danh sách người dùng"}}},"post":{"summary":"Tạo người dùng mới","tags":["Users"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string"},"email":{"type":"string"},"role":{"type":"string","enum":["admin","lecturer","student"]}}}}}},"responses":{"201":{"description":"Tạo người dùng thành công"}}}},"/api/users/statistics":{"get":{"summary":"Lấy thống kê người dùng","tags":["Users"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Thống kê tổng số người dùng, giảng viên, sinh viên, ..."}}}},"/api/users/students/class/{classId}":{"get":{"summary":"Lấy danh sách sinh viên theo lớp học","tags":["Users"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"classId","schema":{"type":"string"},"required":true,"description":"ID của lớp học"}]}},"/api/users/lecturers/course/{courseId}":{"get":{"summary":"Lấy danh sách giảng viên theo khóa học","tags":["Users"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"courseId","schema":{"type":"string"},"required":true}]}},"/api/users/bulk":{"post":{"summary":"Tạo nhiều người dùng cùng lúc","tags":["Users"],"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Tạo nhiều người dùng thành công"}}}},"/api/users/{id}":{"get":{"summary":"Lấy thông tin người dùng theo ID","tags":["Users"],"security":[{"bearerAuth":[]}]},"put":{"summary":"Cập nhật thông tin người dùng","tags":["Users"],"security":[{"bearerAuth":[]}]},"delete":{"summary":"Xóa người dùng theo ID","tags":["Users"],"security":[{"bearerAuth":[]}]}},"/api/users/{id}/toggle-status":{"patch":{"summary":"Kích hoạt / vô hiệu hóa người dùng","tags":["Users"],"security":[{"bearerAuth":[]}]}},"/api/users/{id}/reset-password":{"put":{"summary":"Đặt lại mật khẩu người dùng","tags":["Users"],"security":[{"bearerAuth":[]}]}}},"tags":[{"name":"Classes","description":"API quản lý lớp học"},{"name":"Face Encodings","description":"API quản lý dữ liệu nhận dạng khuôn mặt"},{"name":"System","description":"API hệ thống & kiểm tra trạng thái"},{"name":"Notifications","description":"API quản lý thông báo"},{"name":"Reports","description":"API tạo báo cáo điểm danh và thống kê"},{"name":"Security","description":"API quản lý bảo mật hệ thống — nhật ký truy cập, mã hóa và kiểm tra bảo mật"},{"name":"Settings","description":"API quản lý cấu hình hệ thống — AI, Attendance, Notifications, Storage, Security, Features, Maintenance, Validation"},{"name":"Statistics","description":"API thống kê hệ thống (dành cho Admin, Lecturer, Student)"},{"name":"Subjects","description":"Subject management APIs"},{"name":"Users","description":"API quản lý người dùng (Admin / Lecturer / Student)"}]}